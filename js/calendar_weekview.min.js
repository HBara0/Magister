$(function(){$(".calendar_hour").live('mouseenter',function(){var id=$(this).attr('id').split('_');$(".ui-selected").each(function(){$(this).removeClass('ui-selected')});$("#weekview_table").selectable({filter:"td[id^='"+id[0]+"']",stop:function(event,ui){var from_date=$('.ui-selected')[0].title;var to_date_id=$('.ui-selected')[($('.ui-selected').length)-1].id;var to_date=$('.ui-selected')[($('.ui-selected').length)-1].title;var tonext=(eval(id[1])+1800);var fromdate_details=from_date.split(' ');var to_date_id_details=to_date_id.split('_');var to_date_title=$('#'+id[0]+'_'+(eval(to_date_id_details[1])+1800)).attr('title');var todate_details=to_date_title.split(' ');var from_hours_details=fromdate_details[1].split(':');var to_hours_details=todate_details[1].split(':');$('#pickDate_from').val(fromdate_details[0]);$('#pickDate_to').val(todate_details[0]);$('#fromHour').val(from_hours_details[0]);$('#fromMinutes').val(from_hours_details[1]);$('#toHour').val(to_hours_details[0]);$('#toMinutes').val(to_hours_details[1]);$('#popup_weekview_createentry').dialog('open');$(".ui-dialog, #popup_weekview_createentry").css("overflow","visible")}})});$(".calendar_hourevent").live('mouseover',function(){$(this).draggable({grid:[0,20],stack:".calendar_hourevent",containment:"#weekview_table",axis:"y",zIndex:200,scroll:true,start:function(event,ui,originalPositionTop){$(this).data('originalTop',parseInt(ui.helper.css('top')))},stop:function(event,ui){var depth=30;var id=ui.helper.attr('id').split('_');var diff=((ui.position.top-$(this).data('originalTop'))/20)*(depth*60);$.post("index.php?module=calendar/weekviewoperations&action=update_time",{todiff:diff,fromdiff:diff,id:id[1]})}})});$(".calendar_hourevent").live('mouseover',function(){$(this).resizable({minHeight:20,maxWidth:170,grid:20,handles:'s',ghost:true,containment:"#weekview_table",stop:function(event,ui){var depth=30;var id=ui.element.attr('id').split('_');var diff=((ui.size.height-ui.originalSize.height)/20)*(depth*60);$.post("index.php?module=calendar/weekviewoperations&action=update_time",{todiff:diff,id:id[1]})}})});$("#customer_1_QSearch").live('change',function(){$.post("index.php?module=calendar/weekviewoperations&action=suggest_customervisits",{uid:$('#popup_weekview_createentry').find('#uid').val(),cid:$('#popup_weekview_createentry').find('#cid').val()},function(returnedData){$("#suggestions_Results").show();$("#suggestions_Results").html(returnedData)})});$(".calendar_hourevent").live('click',function(){var id=$(this).attr("id").split("_");sharedFunctions.sharedPopUp('calendar/weekviewoperations','popup_calendar_custvisitsdetails',id[1])});$("img[id^='deleltevisiticon_']").live('click',function(){var id=$(this).attr("id").split('_');$.post("index.php?module=calendar/weekviewoperations&action=delete_visit",{lid:id[1]})})});function drawbox(content){$(".ui-selected").each(function(){$(this).removeClass('ui-selected')});$("#week_days_container").prepend(content);$('#popup_weekview_createentry').dialog('close')}