$(function(){if(jQuery.support.leadingWhitespace==false){$("head").append('<link rel="stylesheet" href="'+rootdir+'css/jqueryuitheme/jquery-ui-current.custom.min.css" type="text/css" />');$("body").append("<div id='browserversionerror' title='Browser version is too old'>Please upgrade your browser to a newer version.</div>");$("#browserversionerror").dialog({bgiframe:true,closeOnEscape:false,modal:true,width:460,maxWidth:460,minHeight:50,zIndex:1,draggable:false})}$("input:checkbox[id$='_checkall']").click(function(){var j=$(this).attr("id").split("_");$('input:checkbox[id^="'+j[0]+'"]').not(this).prop("checked",this.checked)});$('tr[class*="trowtools"]').hover(function(){$(this).toggleClass("altrow2").children('td [id$="_tools"]').find("div").toggle()});$("#login_Button").live("click",c);$("#login_Form input").bind("keypress",function(j){if(j.keyCode==13){c()}});$("#currentmodule_name").hover(function(){$(this).toggleClass("currentmodule_name_hover")});$("#currentmodule_name").click(function(){$(".moduleslist_container").fadeToggle("fast")});$("#mainmenu > li").hover(function(){$(this).not(":has(ul)").addClass("mainmenuitem_hover");if($(this).find("div").css("display")=="none"){$(this).addClass("mainmenuitem_hover")}else{if($(this).find("div").css("display")!="none"){$(this).find("div > ul > li").hover(function(){$(this).toggleClass("submenuitem_hover")})}}},function(){$(this).removeClass("mainmenuitem_hover")});$("#mainmenu > li[class='expandable']").find("span:first").click(function(){$(this).parent().removeClass("mainmenuitem_hover");$("#"+$(this).attr("id")+"_children_container").slideToggle()});$("#mainmenu > li[class!='expandable']").not(":has(div)").find("span").click(function(){window.location="index.php?module="+$(this).attr("id")});$("#mainmenu > li > div > ul > li").find("span").click(function(){window.location="index.php?module="+$(this).attr("id")});if($(window).height()<765){$("#sidedesignImage").height($(window).height())}h();function h(){if($(".inlinetxteditadv").length>0){$(".inlinetxteditadv").each(function(){var k=$(this).attr("id");try{if(!CKEDITOR.instances[k]){CKEDITOR.instances[k].destroy()}CKEDITOR.inline(k);CKEDITOR.instances[k].config.removePlugins="colorbutton,find,flash,font,forms,iframe,image,newpage,removeformat,smiley,specialchar,stylescombo,templates"}catch(j){alert(j)}})}if($(".txteditadv").length>0){$(".txteditadv").each(function(){var k=$(this).attr("id");try{if(CKEDITOR.instances[k]){CKEDITOR.instances[k].destroy()}CKEDITOR.replace(k)}catch(j){alert(k+" "+j)}})}}if($(".texteditormin, .texteditor").length>0){$("head").append('<script src="'+rootdir+'js/redactor.min.js" type="text/javascript"><\/script>');$("head").append('<link rel="stylesheet" href="'+rootdir+'css/redactor.css" type="text/css" />');if($(".texteditor").length>0){$(".texteditor").redactor({buttons:["html","|","formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","table","|","alignment","|","horizontalrule"]})}if($(".texteditormin").length>0){$(".texteditormin").redactor({air:true,airButtons:["bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","alignleft","aligncenter","alignright","justify"],allowedTags:["br","p","b","i","del","strike","blockquote","cite","small","ul","ol","li","dl","dt","dd","sup","sub","pre","strong","em"]})}}if($(".tablefilters_row_toggle").length>0){$(window).on("keydown",function(j){if((j.which==102||j.which==70)&&j.ctrlKey){j.preventDefault();$("#tablefilters, .tablefilters_row").toggle();$("html, body").animate({scrollTop:0},"fast");$("#tablefilters").find("input:first").focus();return false}})}$("input[id^='pickDate']").each(function(){g(this)});function g(j){$(j).datepicker({altField:"#alt"+$(j).attr("id"),altFormat:"dd-mm-yy",dateFormat:"MM dd, yy",showWeek:true,firstDay:1,changeMonth:true,changeYear:true,showAnim:"slideDown"});$("#ui-datepicker-div").css("z-index",$(j).parents(".ui-dialog").css("z-index")+1)}$("input[class*='inlinefilterfield']").live("keyup",function(){var j=$(this).closest("table");setTimeout(function(){j.children("tbody").find("tr").each(function(){var k="show";$(this).show();$(this).find("td").each(function(){var m=j.children("thead").find("th:nth-child("+($(this).index()+1)+') > input[class*="inlinefilterfield"]');if(m.length==0){return}var n=$(this).text().toLowerCase();var l=m.val().toLowerCase();if(l.length==0){return}if(n.indexOf(l)==-1){k="hide";return false}});if(k=="hide"){$(this).hide()}})},300)});$("input[id^='pickDate']").live("click",function(){if(!$(this).hasClass("hasDatepicker")){g(this);$(this).focus()}});var f={};$("input[id$='_autocomplete']").live("keyup",function(){if(sharedFunctions.checkSession()==false){return}var l=$(this).attr("id").split("_");var j=$("input[id='restrictcountry']").val();var k="#"+$(this).attr("id").replace("_autocomplete","_id");if($(this).val().length==0){$(k).val("");$(k+"_output").val("")}$(this).autocomplete({source:function(r,p){var o=r.term;if(l[l.length-2]=="cache"){if(o in f){p(f[o]);return}}var m="";var u="";var t=1;if(l[1]!="noexception"){var q="";if(l[1]=="sectionexception"){q="[id*='"+l[2]+"']"}$("input[id^='"+l[0]+"']"+q+"[id$='_id']").each(function(){if($(this).val().length>0){m+=u+$(this).val();if(++t!=1){u=",";console.log(m)}}})}filtersQuery="";var n=new Array("rid","spid","cid","spid[]","coid");for(var s=0;s<n.length;s++){if($("input[name='"+n[s]+"']").length>0){if($("input[name='"+n[s]+"']").val()!=""){filtersQuery+="&"+n[s]+"="+$("input[name='"+n[s]+"']").val()}}}if(filtersQuery.length>0){filtersQuery+="&filter=1"}$.getJSON(rootdir+"search.php?type=quick&returnType=json&for="+l[0]+"&exclude="+m+filtersQuery,{value:o},function(w,v,x){if(l[l.length-2]=="cache"){f[o]=w}p(w)})},minLength:2,select:function(m,n){$(k).val(n.item.id);if($(k+"_output").length>0){$(k+"_output").val(n.item.id)}}}).data("uiAutocomplete")._renderItem=function(m,n){if(typeof n.desc!="undefined"){return $("<li>").append("<a>"+n.value+"<br><small>"+n.desc+"</small></a>").appendTo(m)}return $("<li>").append("<a>"+n.value+"</a>").appendTo(m)}});$("input[id$='_QSearch']").live("keyup",a);function a(){if(sharedFunctions.checkSession()==false){return}var m=$(this).val();var j=$(this).attr("id").split("_");var s=$(this);if(j.length>=5){var q="#searchQuickResults";for(var o=0;o<(j.length-1);o++){q+="_"+j[o]}}else{var q="#searchQuickResults_"+j[0]+"_"+j[j.length-2]}if($(q).length<=0){q="#searchQuickResults_"+j[j.length-2]}if($("#"+j[0]+"_"+j[j.length-3]+"_"+j[j.length-2]+"_id").length>0){var r="#"+j[0]+"_"+j[j.length-3]+"_"+j[j.length-2]+"_id"}else{var r="#"+j[0]+"_"+j[j.length-2]+"_id"}var k="";var t="";var p=1;if(j[1]!="noexception"){var n="";if(j[1]=="sectionexception"){n="[id*='"+j[2]+"']"}$("input[id^='"+j[0]+"']"+n+"[id$='_id']").each(function(){if($(this).val().length>0){k+=t+$(this).val();if(++p!=1){t=","}}})}filtersQuery="";var l=new Array("rid","spid","cid","spid[]");for(var o=0;o<l.length;o++){if($("input[name='"+l[o]+"']").length>0){if($("input[name='"+l[o]+"']").val()!=""){filtersQuery+="&"+l[o]+"="+$("input[name='"+l[o]+"']").val()}}}if(filtersQuery.length>0){filtersQuery+="&filter=1"}if(m.length==0){$(q).hide();$(r).val("");$(r+"_output").val("")}else{$.post(rootdir+"search.php?type=quick&for="+j[0]+"&exclude="+k+filtersQuery,{value:""+m+""},function(u){if(u.length>0){$(q).html(u);$(q).slideDown();$("#searchResultsList > li").click(function(){s.val($(this).text());$(r).val($(this).attr("id"));$(r+"_output").val($(this).attr("id")).trigger("change");$(q).slideUp()});$(document).not("input[id='"+j[0]+"_"+j[1]+"_QSearch']").click(function(){$(q).slideUp().empty()})}})}m=""}$("input.ajaxcheckbox").live("change",function(){if(sharedFunctions.checkSession()==false){return}var j=$(this).attr("id").split("_");if($(this).is(":checked")==false){$(this).val("0")}sharedFunctions.requestAjax("post","index.php?module="+j[j.length-2],"action="+j[0]+"&value="+$(this).val()+"&id="+j[1],$(this).attr("id")+"_Result",$(this).attr("id")+"_Result")});$(document).on("click","input[type='submit'][id$='_Button']",function(){var l=$(this).attr("id").split("_");var k="";for(var j=0;j<l.length-1;j++){k+=l[j]+"_"}$("form[id='"+k+"Form']:not([action]),form[id='"+k+"Form'][action='#']").submit(function(m){m.preventDefault()})});$(document).on("click","input[id^='perform_'][id$='_Button'],input[id^='add_'][id$='_Button'],input[id^='change_'][id$='_Button']",function(){if(sharedFunctions.checkSession()==false){return}for(instance in CKEDITOR.instances){CKEDITOR.instances[instance].updateElement()}var o=$(this).attr("id").split("_");var m="";for(var l=0;l<o.length-1;l++){m+=o[l]+"_"}var n=$("form[id='"+m+"Form']").serialize();var k=o[o.length-2].split("/");var j="index.php?module="+o[o.length-2];if(!n.match(/action=[A-Za-z0-9]+/)){j+="&action=do_"+o[0]+"_"+k[1]}sharedFunctions.requestAjax("post",j,n,m+"Results",m+"Results")});$("a[id^='showmore_'][href^='#']").click(function(){var j=$(this).attr("id").split("_");$("#"+j[1]+"_"+j[2]).toggle()});$("img[id^='addmore_']").live("click",function(){sharedFunctions.addmoreRows($(this))});$("input[id='email'],input[accept='email']").live("keyup",b);function b(){var m=$(this).closest("form").attr("id");var l=m.substring(0,m.length-5);var k=$("form[id='"+m+"']");var j=$(this).attr("id");if($(this).val()!=""){if(validateEmail($(this).val())){$("input[id='"+l+"_Button']").removeAttr("disabled");$("#"+j+"_Validation").html("<img src='"+imagespath+"valid.gif' />")}else{$("input[id='"+l+"_Button']").attr("disabled","true");$("#"+j+"_Validation").html("<img src='"+imagespath+"invalid.gif' />")}}else{$("input[id='"+l+"_Button']").removeAttr("disabled");$("#"+j+"_Validation").html("")}}$("input[type='button'][id$='_swap']").click(function(){var j=$(this).attr("id").split("_");if($("#"+j[0]+"_last").val().length>0){$("#"+j[0]).val($("#"+j[0]+"_last").val())}});$("input[accept='numeric']").live("keydown",function(j){if(j.keyCode>31&&(j.keyCode<48||(j.keyCode>57&&(j.keyCode<96||j.keyCode>105)&&j.keyCode!=190&&j.keyCode!=110&&j.keyCode!=16&&j.keyCode!=17&&j.keyCode!=59))){j.preventDefault();return false}return true});$("a[id='resetpassword']").live("click",function(){$("#logincontent").hide();$("#resetpasswordcontent").show()});$("#resetpassword_Button").click(function(){sharedFunctions.requestAjax("post","users.php?action=reset_password","email="+$("input[id='email']").val(),"resetpassword_Results","resetpassword_Results")});$("#changepassword_Button").click(function(){sharedFunctions.requestAjax("post","users.php?action=do_changepassword",$("form[id='changepassword_Form']").serialize(),"changepassword_Results","changepassword_Results")});$("#modifyprofile_Button").click(function(){var j=$("form[id='modifyprofile_Form']").serialize();sharedFunctions.requestAjax("post","users.php?action=do_modifyprofile",j,"modifyprofile_Results","modifyprofile_Results")});$("input[id='getReports']").click(function(){if(sharedFunctions.checkSession()==false){return}$.post("index.php?module=reporting/createreports&action=get_reports",{quarter:$("#quarter").val(),year:$("#year").val()},function(j){$("select[id='reports']").empty();$("select[id='reports']").html(j)})});function d(){$("head").append('<link rel="stylesheet" href="'+rootdir+'css/jqueryuitheme/jquery-ui-current.custom.min.css" type="text/css" />');e("","popup_loginbox","users.php")}function c(){$.post(rootdir+"users.php?action=do_login",{username:$("#username").val(),password:$("#password").val(),token:$("#logintoken").val()},function(k){if($("status",k).text()=="true"){var j="green_text"}else{var j="red_text"}$("#login_Results").html("<span class='"+j+"'>"+$("message",k).text()+"</span>").show();if($("#noredirect").val()!="1"){if($("status",k).text()=="true"){goToURL($("#referer").val())}}},"xml")}$("a[id$='_loadpopupbyid'],a[id^='mergeanddelete_'][id$='_icon'],a[id^='revokeleave_'][id$='_icon'],a[id^='approveleave_'][id$='_icon']").live("click",function(){var j=$(this).attr("id").split("_");e(j[2],j[0],j[1])});$(".showpopup,input[id^='showpopup_']").on("click",function(){var j=$(this).attr("id").split("_");$("#popup_"+j[1]).dialog("open")});if($("div[id^='popup_']").length>0){$("div[id^='popup_']").dialog({autoOpen:false,bgiframe:true,closeOnEscape:true,modal:true,width:600,minWidth:600,maxWidth:800,close:function(){$(this).find("form").each(function(){this.reset()});$(this).find("span[id$='_Validation']").empty();$(this).find("span[id$='_Results']").empty()}})}if($("div[id^='tabs_']").length>0){$("div[id^='tabs_']").tabs()}$("a[id^='addnew_']").live("click",function(){var j=$(this).attr("id").split("_");e(j[1],j[0]+"_"+j[2])});$("input[title],a[title],div[title],span[title]").qtip({style:{classes:"ui-tooltip-green ui-tooltip-shadow"},show:{event:"focus mouseenter",solo:true},hide:"unfocus mouseleave",position:{viewport:$(window)}});function e(m,n,o){if(o===undefined){o=""}if(o.length>1){o=o.split("_")}var j="";var k="";for(i=0;i<o.length;i++){if(o[i].length>1){k=k+j+o[i];j="_"}}o=k;if(o!="users.php"){if(sharedFunctions.checkSession()==false){return}}if($("div[id^='popup_']").length>0){}var l="index.php";if(m==""&&o!=""){l=rootdir+o}$.ajax({type:"post",url:l+"?module="+m+"&action=get_"+n,data:"id="+o,beforeSend:function(){$("body").append("<div id='modal-loading'><span  style='display:block; width:100px; height: 100%; margin: 0 auto;'><img  src='./images/loader.gif'/></span></div>");$("#modal-loading").dialog({height:150,modal:true,closeOnEscape:false,title:"Loading...",resizable:false,minHeight:0})},complete:function(){$("#modal-loading").dialog("close").remove()},success:function(p){$(".contentContainer").append(p);h();$("div[id^='popup_']").dialog({bgiframe:true,closeOnEscape:true,modal:true,width:600,minWidth:600,maxWidth:800,zIndex:1000,close:function(){$(this).find("form").each(function(){this.reset()});$(this).find("span[id$='_Validation']").empty();$(this).find("span[id$='_Results']").empty();$(this).remove()}});$("input[id='email']").change(b);$("input[id='hide_popupBox']").click(function(){$("#popupBox").hide("fast")})}})}$("a[href='#'][id^='approve_']").click(function(){if(sharedFunctions.checkSession()==false){return}var j=$(this).attr("id").split("_");var k="&action=do_"+j[0]+"&attribute="+j[2]+"&newvalue="+j[3]+"&id="+j[4];sharedFunctions.requestAjax("post","index.php?module="+j[1],k,$(this).attr("id"),$(this).attr("id"))});$("input[class='inlineCheck']").blur(function(){if($(this).val().length!=0){var l=$(this).parents("form").attr("id").split("_");var j=$(this).attr("id")+"_inlineCheckResult";var k="&action=inlineCheck&attr="+$(this).attr("name")+"&value="+$(this).val();sharedFunctions.requestAjax("post","index.php?module="+l[1],k,j,j)}});$("img[id^='ajaxaddmore_']").live("click",function(){if(sharedFunctions.checkSession()==false){return}var m=$(this).attr("id").split("_");var k=0;var l="";var j="";for(i=2;i<m.length;i++){l=l+j+m[i];j="_"}if($("#numrows_"+l).length!=0){var k=parseInt($("#numrows_"+l).val())}$.ajax({type:"post",url:rootdir+"index.php?module="+m[1]+"&action=ajaxaddmore_"+m[2],data:"value="+k+"&id="+m[m.length-1]+"&"+$("input[id^=ajaxaddmoredata_]").serialize(),beforeSend:function(){$("body").append("<div id='modal-loading'></div>");$("#modal-loading").dialog({height:0,modal:true,closeOnEscape:false,title:"Loading...",resizable:false,minHeight:0})},complete:function(){$("#modal-loading").dialog("close").remove()},success:function(n){$("#"+l+"_tbody").append(n);if($("#numrows_"+l).length!=0){$("#numrows_"+l).val(k+1)}$("html, body").animate({scrollTop:$("#"+l+"_tbody > tr:last").find("input").filter(":visible:first").offset().top},1000);$("#"+l+"_tbody > tr:last").effect("highlight",{color:"#D6EAAC"},1500).find("input").first().focus()}})});window.sharedFunctions=function(){function j(s,n,u,q,t,r,p){if(r==1){r="html"}if(typeof r=="undefined"){r="xml"}var o="loading-bar.gif";$.ajax({type:s,url:n,data:u,beforeSend:function(){$("div[id='"+q+"'],span[id='"+q+"']").html("<img style='padding: 5px;' src='"+imagespath+"/"+o+"'' alt='"+loading_text+"' border='0' />")},complete:function(){if(q!=t){$("#"+q).empty()}},success:function(w){if(r=="xml"){if($(w).find("status").text()=="true"){var v="green_text"}else{var v="red_text"}if($(w).find("message").text().length>0){$("div[id='"+t+"'],a[id='"+t+"'],span[id='"+t+"']").html("<span class='"+v+"'><img src='"+imagespath+"/"+$(w).find("status").text()+".gif' border='0' />&nbsp;"+$(w).find("message").text()+"</span>")}else{$("div[id='"+t+"'],a[id='"+t+"'],span[id='"+t+"']").html(w).dialog()}}else{$("#"+t).html($.trim(w));if(p!="undefined"){if(p=="animate"){$("#"+t).slideDown("slow")}}}}})}function m(){if($.cookie(cookie_prefix+"uid")==null||$.cookie(cookie_prefix+"uid")==0){d();return false}}function l(o){if(typeof o=="object"){var r=o.attr("id").split("_")}else{var r=o.split("_")}if($("#"+r[1]+"_"+r[2]+"_tbody").length>0){r[1]=r[1]+"_"+r[2]}var p=$("#"+r[1]+"_tbody > tr:last").attr("id");var n=parseInt(p)+1;$("#"+r[1]+"_tbody > tr:last").clone(true).removeAttr("id").attr("id",n).appendTo("#"+r[1]+"_tbody");var q=["id","name"];$("#"+r[1]+"_tbody > div").scrollTop();$.each(q,function(s,t){$("#"+r[1]+"_tbody > tr[id='"+n+"']").find("tr["+t+"],input["+t+"],select["+t+"],div["+t+"],span["+t+"],textarea["+t+"],img["+t+"],tbody["+t+"]").each(function(){if($(this).attr(t).length==0){return true}if($(this).attr(t).search(/([A-Za-z_0-9]+)_[\d]+_([A-Za-z_]+)/gi)!=-1){$(this).attr(t,$(this).attr(t).replace(/([A-Za-z_0-9]+)_[\d]+_([A-Za-z_]+)/gi,"$1_"+n+"_$2"))}else{if($(this).attr(t).search(/([A-Za-z_0-9]+)_id[\d]+_([A-Za-z_]+)/gi)!=-1){$(this).attr(t,$(this).attr(t).replace(/([A-Za-z_0-9]+)_id[\d]+_([a-z_]+)/gi,"$1_id"+n+"_$2"))}else{if($(this).attr(t).search(/([A-Za-z_0-9]+)_[\d]/gi)!=-1){$(this).attr(t,$(this).attr(t).replace(/([A-Za-z_0-9]+)_[\d]+/gi,"$1_"+n))}else{if($(this).attr(t).search(/([A-Za-z_0-9]+)_id[\d]/gi)!=-1){$(this).attr(t,$(this).attr(t).replace(/([A-Za-z_0-9]+)_id[\d]+/gi,"$1_id"+n))}else{$(this).attr(t,$(this).attr(t).replace(p,n.toString()))}}}}if($(this).attr("type")!="checkbox"&&$(this).attr("type")!="radio"){$(this).val("")}if($(this).attr("type")=="checkbox"){$(this).removeAttr("checked")}if($(this).is("span")){$(this).html("")}if($(this).hasClass("hasDatepicker")){$(this).removeClass("hasDatepicker")}})});if(r[1]=="keycustomers"){$("#"+r[1]+"_tbody > tr:last").find("td:first").html($("#"+r[1]+"_tbody tr:last").find("td:first").html().replace(p,n.toString()))}$("input[id='email']").change(b);if($("input[id='"+r[1]+"_numrows']").length>0){$("input[id='"+r[1]+"_numrows']").val(n)}else{$("#numrows").val(n)}}function k(n,o,p){e(n,o,p)}return{requestAjax:j,checkSession:m,addmoreRows:l,sharedPopUp:k}}();$("#dimensionfrom, #dimensionto").sortable({connectWith:".sortable",revert:true,cursor:"wait",tolerance:"intersect",placeholder:"ui-state-highlight",over:function(){$(".sortable-placeholder").hide()},dropOnEmpty:true,start:function(){$("#dimensionto li").animate({opacity:2.35,backgroundColor:"#cccccc",})},stop:function(j,k){$("#dimensionto li").css("background","#92d050");$("#dimensions").val($("#dimensionto").sortable("toArray"))}})});function validateEmail(a){return a.match(/^[a-zA-Z0-9&*+\-_.{}~^\?=\/]+@[a-zA-Z0-9-]+\.[a-zA-Z0-9.-]+$/)}function IsNumeric(a,b){if(isNaN(parseFloat(a.value))){alert("The number you have entered is not valid.");a.value="";a.focus();return false}if(b!=""){setTimeout(b,0)}return true}function goToURL(a){if(a!=""){if(!window.location){document.location=a}else{window.location=a}}};